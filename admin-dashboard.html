<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Panel - File Manager</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<div class="container">

    <!-- PANEL UTAMA TANPA LOGIN -->
    <div class="box">
        <h2 style="text-align:center;margin-bottom:20px;">üìÅ ADMIN PANEL ‚Äî MANAGE FILE</h2>

        <input id="judul" placeholder="Judul file">
        <input id="foto" placeholder="URL Gambar">
        <input id="link" placeholder="URL Download File">
        <button onclick="addFile()">+ Tambahkan File</button>

        <h3 style="margin-top:25px">Data File</h3>
        <table id="table"></table>
    </div>

</div>


<script>
const supabase = supabase.createClient(
  "https://sqyftyxqfptggpvwdvlm.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxeWZ0eXhxZnB0Z2dwdndkdmxtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MDU3MDEsImV4cCI6MjA4MDQ4MTcwMX0.TO95Q_mRrp7lfwexCnooVuTKy3fWavRaHFiSvTr6KQs"
);


// TAMBAH DATA
async function addFile(){
    let title = document.getElementById("judul").value;
    let image_url = document.getElementById("foto").value;
    let file_url = document.getElementById("link").value;

    if(!title || !file_url) return alert("Judul & Link tidak boleh kosong!");

    await supabase.from("files").insert([{title,image_url,file_url}]);
    alert("Berhasil ditambahkan!");
    loadFiles();
}


// LOAD FILE LIST
async function loadFiles(){
    let { data } = await supabase.from("files").select("* order by id desc");

    let table = document.getElementById("table");
    table.innerHTML = `<tr><th>Judul</th><th>URL</th><th>Aksi</th></tr>`;

    data.forEach(x=>{
        table.innerHTML+=`
        <tr>
            <td>${x.title}</td>
            <td><a href="${x.file_url}" target="_blank" style="color:#00eaff">Open</a></td>
            <td><button onclick="del('${x.id}')" style="background:red;color:#fff;border:none;padding:7px;border-radius:6px;">Hapus</button></td>
        </tr>`;
    });
}


// DELETE FILE
async function del(id){
    await supabase.from("files").delete().eq("id",id);
    loadFiles();
}


// AUTO TAMPIL SAAT MASUK
loadFiles();
</script>

</body>
</html>
